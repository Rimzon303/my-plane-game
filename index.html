
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sky World Explorer</title>
    <style>
        :root {
            --sky-blue: #A2D9FF;
            --btn-blue: #3498db;
            --win-green: #2ecc71;
            --loss-red: #e74c3c;
            --star-gold: #f1c40f;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            background: linear-gradient(180deg, var(--sky-blue) 0%, #ffffff 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å–æ –ó–≤–µ–∑–¥–∞–º–∏ –∏ –û—á–∫–∞–º–∏ */
        .top-bar {
            background: rgba(255, 255, 255, 0.9);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .balance-item { font-size: 18px; font-weight: bold; }
        .stars-count { color: #f39c12; background: #fef5e7; padding: 5px 12px; border-radius: 15px; display: flex; align-items: center; cursor: pointer; }
        .add-btn { margin-left: 8px; background: #f39c12; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; font-weight: bold; cursor: pointer; line-height: 20px; text-align: center; font-size: 14px; }

        .screen { flex: 1; display: none; flex-direction: column; align-items: center; padding: 15px; overflow-y: auto; }
        .active-screen { display: flex; }

        /* –°–∞–º–æ–ª–µ—Ç */
        #plane { font-size: 100px; margin-top: 50px; cursor: pointer; transition: transform 0.05s; -webkit-tap-highlight-color: transparent; }
        #plane:active { transform: scale(0.85); }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .case-card { background: white; border-radius: 20px; padding: 20px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 80%; max-width: 300px; }
        .spin-anim { font-size: 24px; font-weight: bold; color: #f39c12; margin: 15px 0; min-height: 30px; }

        /* –§–∏–ª—å—Ç—Ä—ã */
        .filters { display: flex; gap: 8px; margin-bottom: 15px; }
        .filter-btn { padding: 6px 12px; border-radius: 15px; border: 1px solid #ddd; background: white; font-size: 14px; }
        .filter-btn.active { background: var(--btn-blue); color: white; border-color: var(--btn-blue); }

        /* –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å */
        .inventory-item { background: white; padding: 15px; border-radius: 15px; margin-bottom: 10px; width: 90%; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }

        /* –ò—Å—Ç–æ—Ä–∏—è */
        .history-item { background: white; padding: 10px; margin-bottom: 5px; border-radius: 8px; width: 95%; display: flex; justify-content: space-between; border-left: 4px solid #ccc; }
        .win { border-left-color: var(--win-green);
 }
        .loss { border-left-color: var(--loss-red); }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-bar { display: grid; grid-template-columns: repeat(4, 1fr); background: white; border-top: 1px solid #eee; }
        .nav-item { padding: 12px 0; text-align: center; font-size: 22px; color: #bbb; cursor: pointer; }
        .nav-item.active { color: var(--btn-blue); }

        .btn { background: var(--btn-blue); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div class="top-bar">
    <div class="balance-item">üí∞ <span id="balance">0</span></div>
    <div class="stars-count" onclick="addStars()">
        ‚≠êÔ∏è <span id="stars">0</span>
        <button class="add-btn">+</button>
    </div>
</div>

<div id="game-screen" class="screen active-screen">
    <div id="plane">‚úàÔ∏è</div>
    <p>–ö–ª–∏–∫–∞–π –Ω–∞ —Å–∞–º–æ–ª—ë—Ç!</p>
</div>

<div id="shop-screen" class="screen">
    <h2>–ú–∞–≥–∞–∑–∏–Ω</h2>
    <div class="case-card">
        <div style="font-size: 50px;">ü•à</div>
        <h3>–°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–µ–π—Å</h3>
        <p>–¶–µ–Ω–∞: 500 üí∞</p>
        <div id="case-result" class="spin-anim">???</div>
        <button class="btn" onclick="openCase()">–û—Ç–∫—Ä—ã—Ç—å –∑–∞ 500</button>
    </div>
</div>

<div id="history-screen" class="screen">
    <h2>–ò—Å—Ç–æ—Ä–∏—è</h2>
    <div class="filters">
        <button class="filter-btn active" onclick="setFilter('all', this)">–í—Å–µ</button>
        <button class="filter-btn" onclick="setFilter('win', this)">–ü–æ–±–µ–¥—ã</button>
        <button class="filter-btn" onclick="setFilter('loss', this)">–ü—Ä–æ–∏–≥—Ä—ã—à–∏</button>
    </div>
    <div id="history-list" style="width: 100%;"></div>
</div>

<div id="inventory-screen" class="screen">
    <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <div id="inventory-list" style="width: 100%;"></div>
</div>

<nav class="nav-bar">
    <div class="nav-item active" onclick="showScreen('game-screen', this)">‚úàÔ∏è</div>
    <div class="nav-item" onclick="showScreen('shop-screen', this)">üõí</div>
    <div class="nav-item" onclick="showScreen('history-screen', this)">üìú</div>
    <div class="nav-item" onclick="showScreen('inventory-screen', this)">üéí</div>
</nav>

<script>
    let score = parseInt(localStorage.getItem('score')) || 0;
    let stars = parseInt(localStorage.getItem('stars')) || 0;
    let history = JSON.parse(localStorage.getItem('history')) || [];
    let inventory = JSON.parse(localStorage.getItem('inventory')) || [];
    let currentFilter = 'all';

    function updateDisplay() {
        document.getElementById('balance').innerText = score;
        document.getElementById('stars').innerText = stars;
        localStorage.setItem('score', score);
        localStorage.setItem('stars', stars);
        localStorage.setItem('history', JSON.stringify(history));
        localStorage.setItem('inventory', JSON.stringify(inventory));
    }

    // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–≤–µ–∑–¥
    function addStars() {
        const amount = prompt("–ö—É—Ä—Å: 1 –∑–≤–µ–∑–¥–∞ =
1000 –æ—á–∫–æ–≤. –°–∫–æ–ª—å–∫–æ –∑–≤–µ–∑–¥ –∫—É–ø–∏—Ç—å?", "1");
        if (amount && !isNaN(amount)) {
            const cost = amount * 1000;
            if (score >= cost) {
                score -= cost;
                stars += parseInt(amount);
                alert(`–í—ã –∫—É–ø–∏–ª–∏ ${amount} ‚≠êÔ∏è`);
                updateDisplay();
            } else {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ (üí∞) –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∑–≤–µ–∑–¥!");
            }
        }
    }

    document.getElementById('plane').onclick = () => {
        score += 10;
        updateDisplay();
    };

    function showScreen(id, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active-screen');
        el.classList.add('active');
        if(id === 'history-screen') renderHistory();
        if(id === 'inventory-screen') renderInventory();
    }

    function openCase() {
        if (score < 500) return alert('–ù—É–∂–Ω–æ 500 üí∞');
        score -= 500;
        const res = document.getElementById('case-result');
        res.innerText = "üåÄ –ñ–¥—ë–º...";
        
        setTimeout(() => {
            const win = Math.floor(Math.random() * 10 + 1) * 100;
            score += win;
            if (win === 1000 && !inventory.includes('–ó–æ–ª–æ—Ç–æ–π –º–∏—à–∫–∞ üß∏')) {
                inventory.push('–ó–æ–ª–æ—Ç–æ–π –º–∏—à–∫–∞ üß∏');
            }
            res.innerText = `+${win} üí∞`;
            history.unshift({ type: win >= 500 ? 'win' : 'loss', amount: win, date: new Date().toLocaleTimeString() });
            updateDisplay();
        }, 800);
    }

    function setFilter(f, btn) {
        currentFilter = f;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderHistory();
    }

    function renderHistory() {
        const list = document.getElementById('history-list');
        list.innerHTML = history
            .filter(item => currentFilter === 'all' || item.type === currentFilter)
            .map(item => `<div class="history-item ${item.type}"><span>${item.amount} üí∞</span><span>${item.date}</span></div>`)
            .join('');
    }

    function renderInventory() {
        const list = document.getElementById('inventory-list');
        list.innerHTML = inventory.length 
            ? inventory.map(i => `<div class="inventory-item"><h3>${i}</h3></div>`).join('')
            : '<center>–ü—É—Å—Ç–æ</center>';
    }

    updateDisplay();
</script>
</body>
</html>
